# literumilo 語根分解問題の詳細分析と修正方法

## 調査実施日
2025-10-15

## 発見された問題の一覧

| No  | 単語               | 現在の結果              | 期待される結果       | 問題の種類                      | 対応状況                   |
| --- | ------------------ | ----------------------- | -------------------- | ------------------------------- | -------------------------- |
| 1   | socialisto         | ❌ 無効                  | social.ist.o         | コード修正が必要                | 解決済 (check_ist を拡張)  |
| 2   | konsentita         | ❌ 無効                  | konsent.it.a         | 辞書データ修正が必要            | 解決済 (他動性を X に修正) |
| 3   | Venontjaraj        | ❌ 無効                  | ven.ont.jar.aj       | アルゴリズム拡張が必要          | 解決済 (venont 語根を追加) |
| 4   | venontjaran        | ❌ 無効                  | ven.ont.jar.an       | アルゴリズム拡張が必要          | 解決済 (venont 語根を追加) |
| 5   | interkonsentite    | ❌ 無効                  | inter.konsent.it.e   | 辞書データ修正が必要 (#2と同根) | 解決済 (他動性を X に修正) |
| 6   | Esperanto-Kongreso | ⚠️ Esperant.oK.on.gres.o | Esperant.o.Kongres.o | 大文字保持ロジックの問題        | 解決済 (境界保持を改良)    |

---

## 調査標準手順

1. **再現する**: 仮想環境を有効化 (`source .venv/bin/activate` または `./.venv/bin/python - <<'PY' ... PY`) した上で、`from literumilo import check_word` を利用して問題語形を列挙し、`res.word` と `res.valid` をメモします。ハイフンを含む語は、元の綴りと表示結果の両方を記録して差分を確認します。

    ```bash
    ./.venv/bin/python - <<'PY'
    from literumilo import check_word
    for word in ["problemo", "ekzemplo"]:
        res = check_word(word)
        print(f"{word}: {res.valid} {res.word}")
    PY
    ```
2. **期待される分解を確定する**: PIV や既存文献、コーパス (`エスペラント例文.txt` など) を参照し、正しく分解された形を明文化します。語尾・接頭辞・派生接尾辞の役割も併記すると、後続判断が容易です。
3. **原因を切り分ける**:
    - 辞書 (`literumilo/data/vortaro.tsv`) に語根・派生辞が存在するか `grep "^dezajn" literumilo/data/vortaro.tsv` のような検索で確認し、品詞・他動性・`with_ending`/`without_ending`・`synthesis` の値が期待通りかを照合します。
    - `literumilo_suffix.py` や `literumilo_scan_morphemes.py` のチェック関数が条件で弾いていないか、該当関数を開いて既存コメント・比較演算 (`<= POS.Adjective` 等) を確認し、`print` デバッグで `MorphemeList` の中身を出力するのも有効です。
    - `find_morpheme` や `check_suffix` が False を返す位置を知りたいときは、一時的にログ (`print("checking", rest_of_word)`) を埋め込み、どこで枝が途切れているかを把握します。
    - 既知の例との共通点 (例: `ne-` + 名詞派生、ハイフン境界、分詞縮約) を探し、再利用できる修正がないか検討します。
4. **対処方針を決める**: 辞書追加で済む場合は最小限のエントリを追加し、同系列語もカバーできるか確認します。コード修正が必要な場合は、既存関数に条件を追加するか、新しいヘルパーを切り出すかを判断し、影響範囲と回帰リスクをメモします。
5. **実装と検証を行う**: 変更後に `python -m compileall literumilo` を実行し構文エラーがないことを確認します。続けて問題語と周辺語形 (派生語尾・複数形など) を `check_word` で再評価し、期待通りの分解になることを確認します。
6. **回帰テストを更新する**: コーパス再生成や専用スニペットの語彙リストに新ケースを追記し、既存ケースで表示が変化していないかを再確認します。必要に応じて `エスペラント例文_語根分解.txt` を再出力します。
7. **ドキュメントを反映する**: 本ファイルに原因・対策・テスト結果を追記し、対応状況を更新します。今後の検討事項があれば「将来拡張」にメモしておきます。

## リファレンス: 辞書と主要モジュール

### `literumilo/data/vortaro.tsv` のカラム

| 列  | 例                 | 意味                                  | 備考                                            |
| --- | ------------------ | ------------------------------------- | ----------------------------------------------- |
| 1   | `dezajn`           | 語根/形態素 (必要に応じて `.` で連結) | X方式の入力は自動でアクセント化される           |
| 2   | `SUBSTVERBO`       | 品詞 (POS)                            | `literumilo_entry.POS` に対応                   |
| 3   | `TECHXNOLOGIO`     | 意味カテゴリ                          | 制約付き接頭辞/後置辞で参照                     |
| 4   | `T`/`N`/`X`        | 他動性                                | 動詞のみ使用。`X` は自他両用                    |
| 5   | `SF`/`N`           | 語尾無しで成立するか                  | 代名詞・前置詞・連接語で利用                    |
| 6   | `KF`/`N`           | 語尾付き語を許可するか                | `KF` は語尾付加可                               |
| 7   | `NLM`/`LM`/`S`/`P` | 結合制約 (Synthesis)                  | `S` suffix、`P` prefix、`LM` 限定、`NLM` 無制限 |
| 8   | `0`〜`4`           | レア度                                | 参考情報                                        |
| 9   | `R`/`K`/`X`        | フラグ                                | `X` は辞書読み込み時に除外される                |

### 主要モジュールの役割

- `literumilo_check_word.py`: 入力語の前処理 (ハイフン除去・境界保存)、語尾抽出、辞書/再帰解析を統括。
- `find_morpheme(...)`: 語幹を再帰的に走査し、辞書ヒットやセパレータ挿入を試みる中心ロジック。
- `literumilo_scan_morphemes.py`: 接頭辞や限定結合の後チェックを担当。`check_ne`, `valid_separator` などの制約がここに集約される。
- `literumilo_suffix.py`: 接尾辞ごとの許容条件を管理。`check_ist`, `check_um`, `check_end_ind` などを通じて品詞・意味の制限を適用。
- `literumilo_utils.py`: 大文字復元や文字種判定、ハイフン境界の処理を担当。
- `literumilo_load.py`: TSV を読み込み `EspDictEntry` を生成。新しいカラム値が増えた場合はここで対応が必要。
- `literumilo_morpheme_list.py`: 分解途中の形態素や語尾情報を保持。表示整形 (`display_form`) にも関与。

### 代表的な切り分けのヒント

- **辞書起因**: `res.valid=False` で `res.word` が原形のまま返る。辞書エントリ追加/修正で解決するケースが多い。
- **接頭辞・接尾辞制約**: 表示が途中まで分解されている場合、該当する `check_*` 関数を確認。条件に `POS` や `meaning` の閾値がハードコードされていないか見る。
- **表示だけの問題**: `res.valid=True` だが大文字・ハイフン位置が崩れるときは `restore_capitals` や強制境界リストを確認。
- **縮約形 (venontjaraj など)**: アルゴリズム拡張よりも辞書追加で済むかを先に検討し、影響範囲とメンテナンス負荷を比較する。

### テストと再現コードの管理

- 小規模検証は簡易な Python スクリプトに語一覧をまとめ、問題語を都度追加して再利用すると効率的です。
- コーパス再解析時は元ファイルのタイムスタンプを記録し、再生成物 (`エスペラント例文_語根分解.txt`) をコミットする際に差分を確認する。
- 主要な修正は `pytest` 等のユニットテストが未整備のため、少なくとも対話内のスニペットを本ドキュメントに貼り付けて再実行できる状態を保つ。

## Problem 1: socialisto (社会主義者)

> ✅ 対応済み: `check_ist` を 2025-10-15 時点で更新し、形容詞語根からの `-ist` 付与を許可しました。

### 採用した修正

- `literumilo/literumilo_suffix.py` の `check_ist` 条件を `pos <= POS.Adjective` に拡張し、名詞・動詞・形容詞すべてから `-ist` を許容。
- 回帰テストに `socialisto` 系列を追加して動作確認。

### 当時の調査メモ (参考)

以下は初回調査時の記録です。現状実装とは異なる案も含みます。

#### 問題の詳細

**現在の動作:**
- `socialisto` → 無効 (分解失敗)

**期待される動作:**
- `socialisto` → `social.ist.o` (✓有効)

### 根本原因

**ファイル:** `literumilo/literumilo_suffix.py` (行386-397)

```python
def check_ist(index, morpheme_list):
    """Check suffix -ist, meaning 'a professional, supporter of a idea, doctrine, etc.'.
    Eg. Esperant-ist-o (Esperantisto)
    For a description of parameters see check_acx().
    """
    if index == 0: return False
    previous_entry = morpheme_list.get(index - 1)
    if previous_entry:
        pos = previous_entry.part_of_speech
        meaning = previous_entry.meaning
        if  pos <= POS.Verb and (not is_person(meaning)): return True  # ← 問題の行
    return False
```

**問題点:**
- 条件: `pos <= POS.Verb` は「名詞 (1) または動詞 (3) またはそれ以下」のみを許可
- `social` は形容詞 (POS.Adjective = 4)
- 4 <= 3 は False となり、check_ist が失敗

**実際のエスペラント:**
- 形容詞からも `-ist` で人を作ることができる:
  - `social` → `socialisto` (社会主義者)
  - `ideal` → `idealisto` (理想主義者)
  - `material` → `materialisto` (唯物論者)
  - `komunist` → `komunisto` (共産主義者)

#### 修正方法

##### オプション1: コード修正 (推奨)

**ファイル:** `literumilo/literumilo_suffix.py` (行396)

**修正前:**
```python
if  pos <= POS.Verb and (not is_person(meaning)): return True
```

**修正後:**
```python
if  pos <= POS.Adjective and (not is_person(meaning)): return True
```

**理由:**
- 形容詞 (POS.Adjective = 4) も許可する
- これにより、名詞・動詞・形容詞すべてから `-ist` を作成可能

##### オプション2: 辞書データ修正

**ファイル:** `literumilo/data/vortaro.tsv`

```tsv
# 追加行
socialist	SUBST	PERSONO	N	N	KF	NLM	3	R
```

**利点:**
- 即座に動作
- コード変更不要

**欠点:**
- 他の同様の単語（idealisto, materialisto など）も個別に追加が必要
- 辞書が肥大化

---

## Problem 2 & 4: konsentita / interkonsentite (同意された)

> ✅ 対応済み: 辞書の `konsent` エントリを `X` (自他両用) に更新済みです。

### 採用した修正

- `literumilo/data/vortaro.tsv` の `konsent` 行で他動性を `N` → `X` に修正。
- `interkonsentite` など派生語を回帰テストに追加。

### 当時の調査メモ (参考)

以下は初回調査時の記録です。現状実装とは異なる案も含みます。

#### 問題の詳細

**現在の動作:**
- `konsentita` → 無効 (分解失敗)
- `interkonsentite` → 無効 (分解失敗)

**期待される動作:**
- `konsentita` → `konsent.it.a` (✓有効)
- `interkonsentite` → `inter.konsent.it.e` (✓有効)

### 根本原因

**ファイル:** `literumilo/data/vortaro.tsv` (行数不明)

```tsv
konsent	VERBO	N	N	N	KF	NLM	0	R
        ^^^^       ^
        動詞      他動性=自動詞(N)
```

**問題点:**
- `konsent` の他動性フィールドが `N` (自動詞=Intransitive)
- 受動分詞 `-it-` は他動詞 (Transitive) にのみ使用可能
- そのため `konsent.it.a` が拒否される

**実際のエスペラント:**
- `konsenti` は他動詞として使用可能:
  - `Mi konsentas vian proponon.` (私はあなたの提案に同意する)
  - `La propono estas konsentita.` (提案は同意された)

#### 修正方法

##### 辞書データ修正 (必須)

**ファイル:** `literumilo/data/vortaro.tsv`

**修正前:**
```tsv
konsent	VERBO	N	N	N	KF	NLM	0	R
```

**修正後:**
```tsv
konsent	VERBO	N	X	N	KF	NLM	0	R
```

**変更点:**
- 他動性フィールド: `N` (自動詞) → `X` (自動詞と他動詞の両方)

**理由:**
- `X` (両用) にすることで、自動詞用法も他動詞用法も許可
- これにより受動分詞 `-it-` が使用可能になる

---

## Problem 3: Venontjaraj / venontjaran (来たる年々の)

> ✅ 現在の運用: `venont` を形容詞語根として辞書に追加し、縮約形を辞書経由で吸収しています。アルゴリズム拡張案は将来検討とします。

### 採用した修正

- `literumilo/data/vortaro.tsv` に `venont	ADJ` を追加し、縮約形を一語として解析可能にする。
- 回帰テストに `Venontjaraj`, `venontjaran` を追加し期待出力を `venont.jar.*` へ揃える。

### 当時の調査メモ (参考)

以下は初回調査時の記録です。現状実装とは異なる案も含みます。

#### 問題の詳細

**現在の動作:**
- `Venontjaraj` → 無効 (分解失敗)
- `venontjaran` → 無効 (分解失敗)

**期待される動作:**
- `Venontjaraj` → `ven.ont.jar.aj` (✓有効)
- `venontjaran` → `ven.ont.jar.an` (✓有効)

### 根本原因

**構造の理解:**
```
venontjaraj
├─ venont (coming, 来たる) → ven + ont (動詞 + 未来能動分詞)
│  └─ 本来は venonta だが、縮約形として venont-
└─ jaraj (yearly, 年々の) → jar + aj (名詞語根 + 形容詞複数語尾)
```

**エスペラントの文法:**
- `venonta jara` (2語) = 来たる年の
- `venontjara` (1語、縮約形) = 同じ意味
- 縮約時、形容詞語尾 `-a` を省略して直接結合

**現在のアルゴリズムの問題:**

1. `venontjaraj` → 語尾 `aj` 除去 → `venontjar`
2. `venontjar` を分解:
   - `ven` (✓ 見つかる) + `ontjar` (続行)
3. `ontjar` を分解:
   - `ont` (✓ 分詞として見つかる) + `jar` (続行)
4. **問題発生:**
   - `ont` は分詞 (synthesis=Participle)
   - `ont` は `with_ending=No` (語尾を必要とする)
   - しかし次の `jar` は語根であり、語尾ではない
   - → 検証失敗

**アルゴリズムの制約:**
- 分詞は語尾と組み合わせることを期待
- 分詞 + 別の語根 という組み合わせを想定していない

#### 修正方法

##### オプション1: 分詞の結合ルールを拡張 (推奨、難易度: 高)

**ファイル:** `literumilo/literumilo_scan_morphemes.py` (行546付近)

**修正の方向性:**
- `check_participle()` 関数を拡張
- 分詞の後に語根が来る場合を許可
- ただし、その語根が形容詞化可能であることを確認

**擬似コード:**
```python
def check_participle(index, morpheme_list):
    # 既存のチェック...

    # 新規: 次の形態素が語根の場合
    if index < last:
        next_entry = morpheme_list.get(index + 1)

        # 次が語根で、形容詞化可能な場合
        if next_entry.synthesis in [Synthesis.UnLimited, Synthesis.Limited]:
            if next_entry.with_ending == WithEnding.Yes:
                # 形容詞の縮約形として許可
                return True

    # 既存の処理...
```

**課題:**
- 複雑なケースを正しく処理する必要がある
- 誤判定のリスク

##### オプション2: 辞書に縮約形を追加 (簡易、推奨)

**ファイル:** `literumilo/data/vortaro.tsv`

```tsv
# 追加行
venontjar	ADJ	N	N	N	KF	NLM	3	K
```

**フィールド説明:**
- `venontjar`: 形態素
- `ADJ`: 形容詞
- `N`: 意味カテゴリなし
- `N`: 他動性なし
- `N`: 語尾なしでは使えない
- `KF`: 語尾ありで使える
- `NLM`: 無制限に結合可能
- `3`: 稀少度 (やや稀)
- `K`: 複合語フラグ

**利点:**
- 即座に動作
- コード変更不要

**欠点:**
- 同様のパターン（venontmonata, pasintjaraなど）も個別に追加が必要
- 辞書が肥大化

##### オプション3: 語根2つを辞書に追加 (最小限)

**ファイル:** `literumilo/data/vortaro.tsv`

```tsv
# 単に venont を語根として追加
venont	ADJ	N	N	N	KF	NLM	3	R
```

**理由:**
- `venont` を独立した形容詞語根として認識
- `ven.ont` ではなく `venont` として処理
- これにより `venont.jar.aj` が可能に

**利点:**
- シンプル
- 他の組み合わせ (venont + 他の語根) も自動対応

**欠点:**
- 本来の形態素分解 (`ven + ont`) が失われる

---

## Problem 6: Esperanto-Kongreso (大文字保持の問題)

> ✅ 対応済み: ハイフン境界保持ロジックと `restore_capitals` の改修を適用済みです。

### 採用した修正

- `literumilo_check_word.py` でハイフン境界を強制的に保持し、`restore_capitals` に渡す際の境界情報を維持。
- `literumilo/literumilo_utils.py` の `restore_capitals` で非語字符を飛ばしながら元の大文字を復元するよう改修。

### 当時の調査メモ (参考)

以下は初回調査時の記録です。現状実装とは異なる案も含みます。

#### 問題の詳細

**現在の動作:**
- `Esperanto-Kongreso` → `Esperant.oK.on.gres.o` (⚠️ 不正確)

**期待される動作:**
- `Esperanto-Kongreso` → `Esperant.o.Kongres.o` (✓正確)

### 根本原因

**ファイル:** `literumilo/literumilo_utils.py` (行99-128)

```python
def restore_capitals(original, analyzed):
    """The Esperanto dictionary (vortaro) has only lower case morphemes, so words
    are converted to lower case for dictionary lookups. It might be useful to
    convert words back to their original case after analysis. For example, an
    analysis of the word  'RIĈULO' will produce 'riĉ.ul.o'. This function will take
    'RIĈULO' and 'riĉ.ul.o' to produce 'RIĈ.UL.O'.
    """
    result = ""
    index = 0
    original_length = len(original)

    for ch in analyzed:
        if ch == ".":
            result += "."
        else:
            if (index < original_length):
                result += original[index]  # ← 問題: ハイフンが考慮されていない
            else:
                result += ch
            index += 1
    return result
```

**問題点:**
- 元の単語 `Esperanto-Kongreso` にはハイフン `-` が含まれる
- しかし分析結果 `esperant.o.kongres.o` にはハイフンが含まれない
- `restore_capitals` は文字を1:1で対応させようとする
- ハイフンの存在により、インデックスがずれる

**具体例:**
```
Original:  E s p e r a n t o - K o n g r e s o
Index:     0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
Analyzed:  e s p e r a n t . o . k o n g r e s . o
           ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑     ↑     ↑ ←インデックスずれ
```

#### 修正方法

##### コード修正 (推奨)

**ファイル:** `literumilo/literumilo_utils.py` (行99-128)

**修正案:**

```python
def restore_capitals(original, analyzed):
    """Restore original capitalization, accounting for hyphens and special chars."""
    result = ""
    original_index = 0
    original_length = len(original)

    for ch in analyzed:
        if ch == ".":
            result += "."
        else:
            # Skip hyphens and other non-word characters in original
            while original_index < original_length:
                orig_ch = original[original_index]
                if not is_word_char(orig_ch):
                    original_index += 1
                    continue
                break

            # Restore capital
            if original_index < original_length:
                result += original[original_index]
                original_index += 1
            else:
                result += ch

    return result
```

**変更点:**
- 元の単語でハイフンなどの非単語文字をスキップ
- 単語文字のみをマッチング
- インデックスずれを防止

---

## 推奨される修正の優先順位

### 優先度: 高 (即座に修正すべき)

1. **Problem 2: konsentita の他動性修正**
   - **ファイル:** `literumilo/data/vortaro.tsv`
   - **変更:** `konsent` の他動性を `N` → `X` に変更
   - **影響:** 小
   - **難易度:** 低

2. **Problem 1: socialisto のコード修正**
   - **ファイル:** `literumilo/literumilo_suffix.py` (行396)
   - **変更:** `pos <= POS.Verb` → `pos <= POS.Adjective`
   - **影響:** 中 (他の `-ist` 接尾辞にも影響)
   - **難易度:** 低

### 優先度: 中 (検討すべき)

3. **Problem 6: Esperanto-Kongreso の大文字保持修正**
   - **ファイル:** `literumilo/literumilo_utils.py` (行99-128)
   - **変更:** `restore_capitals()` 関数を書き換え
   - **影響:** 小 (表示のみ、機能は変わらない)
   - **難易度:** 中

4. **Problem 3: venontjaraj の辞書追加**
   - **ファイル:** `literumilo/data/vortaro.tsv`
   - **変更:** `venont` を形容詞語根として追加
   - **影響:** 小
   - **難易度:** 低

### 優先度: 低 (将来的な拡張)

5. **Problem 3: venontjaraj のアルゴリズム拡張**
   - **ファイル:** `literumilo/literumilo_scan_morphemes.py`
   - **変更:** 分詞 + 語根 の組み合わせを許可
   - **影響:** 大 (多くの縮約形に対応)
   - **難易度:** 高

---

## 修正後のテスト計画

### テストケース

```python
test_cases = [
    # Problem 1
    ("socialisto", "social.ist.o", True),
    ("idealisto", "ideal.ist.o", True),
    ("materialisto", "material.ist.o", True),

    # Problem 2
    ("konsentita", "konsent.it.a", True),
    ("konsentite", "konsent.it.e", True),

    # Problem 4
    ("interkonsentite", "inter.konsent.it.e", True),

    # Problem 3 (辞書追加後)
    ("venontjara", "venont.jar.a", True),
    ("venontjaraj", "venont.jar.aj", True),
    ("venontjaran", "venont.jar.an", True),

    # Problem 6
    ("Esperanto-Kongreso", "Esperant.o.Kongres.o", True),

    # 既存機能の回帰テスト
    ("miskomprenita", "mis.kompren.it.a", True),
    ("ĉirkaŭiris", "ĉirkaŭ.ir.is", True),
    ("esperantisto", "esperant.ist.o", True),
]
```

---

## まとめ

### 発見された問題の分類と対応状況

| 区分             | 主な対象                                                                                                                 | 対応状況 |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------ | -------- |
| コード修正       | `check_ist`, `check_end_ind`, `check_um`, `check_ne`, `valid_separator`, ハイフン整形 (`check_word`), `restore_capitals` | 完了     |
| 辞書データ修正   | `konsent` の他動性、`ekskurs` の品詞、`-um` 接尾辞エントリ                                                               | 完了     |
| 辞書追加         | `roma`, `video`, `venont`, `dezajn` など不足語根の追加                                                                   | 完了     |
| ドキュメント更新 | 本ファイル、README、`エスペラント例文_語根分解.txt` の再生成                                                             | 完了     |
| 将来検討         | 分詞縮約の一般化、ユーザー定義オーバーライド機能                                                                         | 継続検討 |

### 今後の優先順位

1. ✅ 実施済み: 辞書の他動性・語根追加 (`konsent`, `venont`, `dezajn` など)
2. ✅ 実施済み: 接尾辞/接頭辞ロジックの補強 (`check_ist`, `check_end_ind`, `check_um`, `check_ne`, `valid_separator`)
3. ✅ 実施済み: 表示まわりの安定化 (ハイフン略語整形と `restore_capitals` の改善)
4. ✅ 実施済み: 回帰テストスニペットとコーパスの更新
5. 🔄 継続課題: 分詞縮約 (例: `ven.ont.jar.a` → `venont.jar.a`) をアルゴリズムで自然に扱う仕組み。`literumilo_scan_morphemes.check_participle` や `find_morpheme` の分岐にフックを入れ、既存ケースを壊さずに適用する方針を検討する。
6. 💡 構想段階: ユーザーが語形ごとの分解を上書きできるオーバーライド設定。`check_word` 実行前に外部ファイル (仮: `user_overrides.tsv`) を読み込み、完全一致語を `AnalysisResult` へ直接返す前処理フックを追加する案を検討中。

すべての既知問題について一次対応は完了しました。今後は継続課題の検討と、新規に報告された語形を本ドキュメントの手順に沿って処理してください。

---

## 追加調査: 例文コーパスで新たに判明した問題と対策

最新版の語根分解器で `エスペラント例文.txt` を再解析したところ、以下の追加課題が見つかりました。

| No  | 語形               | 現状                    | 期待                 | 原因 (判明時点)              | 主な対策                                | 対応状況 |
| --- | ------------------ | ----------------------- | -------------------- | ---------------------------- | --------------------------------------- | -------- |
| 7   | ekskursante        | ❌ ekskursante           | ekskurs.ant.e        | `ekskurs` が名詞扱い         | `vortaro.tsv` で `SUBSTVERBO` に変更    | 解決済   |
| 8   | romaa / romaaj     | ❌ romaa / romaaj        | roma.a / roma.aj     | `roma` 語根が欠落            | `roma` を ETNO として追加               | 解決済   |
| 9   | subedekstra        | ❌ subedekstra           | sub.e.dekstr.a       | 接頭辞＋母音セパレータが拒否 | `valid_separator` を prefix 対応へ拡張  | 解決済   |
| 10  | fierindan          | ❌ fierindan             | fier.ind.an          | `-ind` が形容詞に繋がらない  | `check_end_ind` で形容詞→`-ind` を許容  | 解決済   |
| 11  | videoludon         | ❌ vid.e.o.lud.on        | video.lud.on         | `video` 語根欠落             | `video` を TECHXNOLOGIO として追加      | 解決済   |
| 12  | amikumante         | ❌ amikumante            | amik.um.ant.e        | `-um` 接尾辞が認識されない   | `check_um` を追加して `-um` を許可      | 解決済   |
| 13  | n-ro / s-ino 系    | ⚠️ nro.o / sino.o        | n.ro / s.in.o        | 略語の表示用整形が不足       | `check_word` でハイフン略語の整形を追加 | 解決済   |
| 14  | Esperanto-Kongreso | ⚠️ Esperant.oK.on.gres.o | Esperant.o.Kongres.o | ハイフン境界が失われる       | 既存対応: 強制境界の導入                | 解決済   |
| 15  | neregulaĵoj        | ❌ neregulaĵoj           | ne.regul.aĵ.oj       | `ne-` が `-aĵ` 名詞を拒否    | `check_ne` で `-aĵ` を許可              | 解決済   |
| 16  | dezajnojn          | ❌ dezajnojn             | dezajn.ojn           | `dezajn` 語根欠落            | `dezajn` を SUBSTVERBO として追加       | 解決済   |

### 実施した修正

- `literumilo/data/vortaro.tsv`
    - `ekskurs` を `SUBSTVERBO` 化 (名詞＋動詞両用)
    - `roma`, `video` の語根を追加
    - `-um` 接尾辞エントリを復帰
    - `dezajn` を SUBSTVERBO として追加
- `literumilo/literumilo_scan_morphemes.py`
    - `valid_separator()` に接頭辞／前置詞後のセパレータ例外を追加
    - `check_ne()` で `-aĵ` 派生名詞を許可
- `literumilo/literumilo_suffix.py`
    - `check_end_ind()` で形容詞＋`-ind` を許容 (Mir-ind-a 等に対応)
    - `check_um()` を新設し `-um` を再有効化
- `literumilo/literumilo_check_word.py`
    - ハイフン略語 (`n-ro`, `s-ino` 等) の表示整形を追加
    - ハイフン境界強制ロジック (従来修正の補強) を維持
- `エスペラント例文_語根分解.txt`
    - 上記修正後、元の `エスペラント例文.txt` から再生成

### 主な回帰テスト

```python
from literumilo import check_word

words = [
        "semajnon",
        "ekskursante", "ekskursantaj",
        "romaa", "romaaj",
        "subedekstra",
        "persone", "personeco",
        "apartenas",
        "videoludon",
        "fierinda", "fierindan",
        "Esperanto-Kongreso",
        "amikumante",
    "neregulaĵoj",
    "dezajnojn",
        "n-ro", "s-ino"
]

for w in words:
        res = check_word(w)
        print(w, res.valid, res.word)
```

期待結果 (抜粋):

```
ekskursante True ekskurs.ant.e
romaaj True roma.aj
subedekstra True sub.e.dekstr.a
videoludon True video.lud.on
fierindan True fier.ind.an
Esperanto-Kongreso True Esperant.o.Kongres.o
amikumante True amik.um.ant.e
neregulaĵoj True ne.regul.aĵ.oj
dezajnojn True dezajn.ojn
n-ro True n.ro
```

また、`python -m compileall literumilo` を実行し、構文エラーがないことを確認済み。

---
